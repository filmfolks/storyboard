<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FILM FOLKS STORYBOARD</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; background: #fafafa; margin: 0; }
.dark-mode { background: #121212; color: #f0f0f0; }
.dark-mode .storyboard-container { background: #1e1e1e; }
.dark-mode input, .dark-mode textarea, .dark-mode select { background: #222; color: #fff; border-color: #555; }
.dark-mode .storyboard-panel { background: #2a2a2a; }
.dark-mode button { background: #444 !important; color: #eee !important; }
.storyboard-container { max-width: 1200px; margin: 20px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 10px #bbb; padding: 16px; }
.top-section { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; margin-bottom: 20px; }
.top-fields { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
.top-fields input { font-size: 16px; padding: 6px 9px; border: 1px solid #bbb; border-radius: 4px; width: 200px; }
.saved-header { display: none; text-align: center; }
.saved-title { font-size: 18px; font-weight: bold; letter-spacing: 1px; }
.saved-director,.saved-sequence { font-size: 13px; margin: 0 8px; }
button { border: none; border-radius: 4px; padding: 8px 14px; cursor: pointer; }
.save-btn { background: #28a745; color: #fff; }
.edit-btn { background: #ffc107; color: #212529; display: none; }
.add-shot-main { background: #2274a5; color: white; }
.add-shot-mobile { display: none; background: #28a745; color: white; margin-top: 8px; }
#previewModeBtn { background: #444fc7; color: #fff; margin-left: 10px; }
#darkModeBtn { background: #333; color: #fff; margin-top: 10px; }
#exitPreviewBtn { background: #c72b2b; }
#prevBtn,#nextBtn { background: #174668; color: white; }
#prevBtn:disabled,#nextBtn:disabled { opacity: 0.5; cursor: not-allowed; }
.storyboard-row { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; justify-content: flex-start; }
.storyboard-panel { background: #f4f4f4; border-radius: 8px; padding: 12px; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; break-inside: avoid; page-break-inside: avoid; }
.storyboard-thumbnail { width: 190px; height: 120px; background: #ddd; border-radius: 4px; object-fit: cover; margin-top: 6px; }
.panel-label { font-weight: bold; width: 100%; margin: 5px 0 3px; }
input,textarea,select { width: 100%; font-size: 15px; padding: 4px 7px; border-radius: 3px; border: 1px solid #ccc; margin-bottom: 8px; }
textarea { resize: vertical; }
#previewArea { display: none; text-align: center; max-width: 500px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px #bbb; }
.preview-thumbnail { width: 250px; height: auto; border-radius: 4px; }
.print-shotname { font-size: 20px; font-weight: bold; margin: 10px 0; }
.print-description { font-size: 16px; margin-top: 10px; }
.print-select { font-size: 12px; font-style: italic; margin-top: 4px; color: #333; }
@media (max-width: 768px) {
  .storyboard-row { flex-direction: column; align-items: center; }
  .storyboard-panel { width: 95% !important; }
  .storyboard-thumbnail { width: 100% !important; height: auto !important; }
  .add-shot-main { display: none; }
  .add-shot-mobile { display: inline-block; }
  #previewArea { max-width: 95%; }
  .preview-thumbnail { width: 100%; }
}
@media print {
  @page { margin: 0.5cm; }
  button, input, textarea, select, .panel-label, .add-shot-main, .add-shot-mobile, #previewModeBtn, #previewArea {
    display: none !important;
  }
  .saved-header {
    display: block !important;
    text-align: center;
    margin-bottom: 10px;
  }
  .storyboard-row {
    flex-direction: row !important;
    flex-wrap: wrap !important;
    gap: 6mm !important;
    justify-content: flex-start !important;
    max-width: 210mm;
    margin: 0 auto;
  }
  .storyboard-panel {
    width: calc((100% / 5) - 6mm) !important;
    padding: 4mm !important;
    box-sizing: border-box;
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }
  .storyboard-thumbnail {
    width: 100% !important;
    height: auto !important;
    display: block !important;
    object-fit: cover;
  }
  .print-shotname, .print-select, .print-description {
    display: block !important;
    text-align: center;
    margin: 4px 0;
    font-size: 12pt;
  }
}
</style>
</head>
<body>
<div class="storyboard-container" id="mainStoryboard">
  <div class="top-section">
    <div class="top-fields" id="editFields">
      <input type="text" id="titleField" placeholder="Storyboard Title" />
      <input type="text" id="directorField" placeholder="Director Name" />
      <input type="text" id="sequenceField" placeholder="Sequence" />
      <button class="save-btn" onclick="saveHeader()">Save</button>
    </div>
    <div class="saved-header" id="savedHeader">
      <div class="saved-title" id="savedTitle"></div>
      <span class="saved-director" id="savedDirector"></span>
      <span class="saved-sequence" id="savedSequence"></span>
      <button class="edit-btn" onclick="editHeader()">Edit</button>
    </div>
  </div>
  <div id="storyboardRows"></div>
  <button class="add-shot-main" onclick="addPanel()">Add Shot</button>
  <button onclick="window.print()">Print as PDF</button>
  <button id="previewModeBtn">Preview</button>
  <button id="darkModeBtn" onclick="toggleDarkMode()">Toggle Dark Mode</button>
</div>
<div id="previewArea">
  <div id="previewHeader"></div>
  <div>
    <div class="print-shotname" id="previewShotName"></div>
    <div class="print-select" id="previewSelects"></div>
    <img id="previewThumb" class="preview-thumbnail" alt="Thumbnail" />
    <div class="print-description" id="previewDesc"></div>
  </div>
  <div style="margin-top: 15px;">
    <button id="prevBtn">Previous</button>
    <button id="nextBtn">Next</button>
    <button id="exitPreviewBtn">Exit Preview</button>
  </div>
</div>
<script>
let panels = [], panelId = 0, currentPreviewIdx = 0;
let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

function renderStoryboard() {
  const rows = document.getElementById("storyboardRows");
  rows.innerHTML = "";
  if (isMobile) {
    panels.forEach((panel) => {
      const wrap = document.createElement("div");
      wrap.className = "storyboard-row";
      wrap.appendChild(panel);
      const btn = document.createElement("button");
      btn.className = "add-shot-mobile";
      btn.textContent = "Add Next Shot";
      btn.onclick = addPanel;
      wrap.appendChild(btn);
      rows.appendChild(wrap);
    });
  } else {
    for (let i = 0; i < panels.length; i += 5) {
      const row = document.createElement("div");
      row.className = "storyboard-row";
      for (let j = i; j < i + 5 && j < panels.length; j++) {
        row.appendChild(panels[j]);
      }
      rows.appendChild(row);
    }
  }
}
function addPanel() {
  panelId++;
  const panel = document.createElement("div");
  panel.className = "storyboard-panel";
  panel.innerHTML = `
    <label class="panel-label">Shot Number</label>
    <input type="text" id="scene${panelId}" oninput="syncLabels(${panelId})" placeholder="e.g. 1" />
    <label class="panel-label">Shot Size</label>
    <select id="shotSize${panelId}" onchange="syncLabels(${panelId})">
      <option value="">-- Select --</option>
      <option>Extreme Long Shot (ELS)</option>
      <option>Long (LS) / Wide (WS)</option>
      <option>Medium Long (MLS) / Medium Wide (MWS)</option>
      <option>Full Shot (FS)</option>
      <option>Medium Shot (MS)</option>
      <option>Medium Close-Up (MCU)</option>
      <option>Close-Up (CU)</option>
      <option>Extreme Close-Up (ECU)</option>
      <option>Cowboy Shot (CS)</option>
      <option>Choker Shot</option>
      <option>Establishing Shot</option>
    </select>
    <label class="panel-label">Camera Angle</label>
    <select id="camAngle${panelId}" onchange="syncLabels(${panelId})">
      <option value="">-- Select --</option>
      <option>Eye-Level</option>
      <option>High Angle</option>
      <option>Low Angle</option>
      <option>Bird's-Eye View / Overhead</option>
      <option>Worm's-Eye View</option>
      <option>Dutch Angle / Canted Angle</option>
    </select>
    <label class="panel-label">Framing & Composition</label>
    <select id="framing${panelId}" onchange="syncLabels(${panelId})">
      <option value="">-- Select --</option>
      <option>Single Shot</option>
      <option>Two-Shot</option>
      <option>Three-Shot</option>
      <option>Over-the-Shoulder (OTS)</option>
      <option>Point-of-View (POV)</option>
      <option>Master Shot</option>
    </select>
    <label class="panel-label">Camera Movement</label>
    <select id="camMovement${panelId}" onchange="syncLabels(${panelId})">
      <option value="">-- Select --</option>
      <option>Static Shot</option>
      <option>Pan</option>
      <option>Tilt</option>
      <option>Tracking Shot / Dolly Shot</option>
      <option>Zoom Shot</option>
      <option>Dolly Zoom</option>
      <option>Truck Shot</option>
      <option>Pedestal Shot</option>
      <option>Roll Shot</option>
    </select>
    <label class="panel-label">Focus Technique</label>
    <select id="focusTech${panelId}" onchange="syncLabels(${panelId})">
      <option value="">-- Select --</option>
      <option>Rack Focus / Focus Pull</option>
      <option>Shallow Focus</option>
      <option>Deep Focus</option>
      <option>Soft Focus</option>
      <option>Tilt-Shift</option>
      <option>Split Diopter</option>
    </select>
    <label class="panel-label">Description</label>
    <textarea id="desc${panelId}" oninput="syncLabels(${panelId})"></textarea>
    <input type="file" accept="image/*" id="img${panelId}" onchange="previewImg(event, ${panelId})" />
    <span class="print-shotname" id="printShot${panelId}" style="display:none;"></span>
    <span class="print-select" id="printSelects${panelId}" style="display:none;"></span>
    <img id="thumb${panelId}" class="storyboard-thumbnail" style="display:none;" />
    <span class="print-description" id="printDesc${panelId}" style="display:none;"></span>
  `;
  panels.push(panel);
  renderStoryboard();
}
function syncLabels(id) {
  const scene = document.getElementById(`scene${id}`).value.trim();
  const selections = [
    document.getElementById(`shotSize${id}`).value,
    document.getElementById(`camAngle${id}`).value,
    document.getElementById(`framing${id}`).value,
    document.getElementById(`camMovement${id}`).value,
    document.getElementById(`focusTech${id}`).value
  ].filter(Boolean).join(", ");
  document.getElementById(`printShot${id}`).textContent = scene ? scene + "." : "";
  document.getElementById(`printDesc${id}`).textContent = capitalizeWords(document.getElementById(`desc${id}`).value.trim());
  const selectsSpan = document.getElementById(`printSelects${id}`);
  if (selections) {
    selectsSpan.style.display = "block";
    selectsSpan.textContent = selections;
  } else {
    selectsSpan.style.display = "none";
  }
}
function previewImg(e, id) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = (ev) => {
    const img = document.getElementById(`thumb${id}`);
    img.src = ev.target.result;
    img.style.display = "block";
  };
  reader.readAsDataURL(file);
}
function saveHeader() {
  document.getElementById("savedTitle").textContent = document.getElementById("titleField").value.toUpperCase();
  document.getElementById("savedDirector").textContent = capitalizeWords(document.getElementById("directorField").value);
  document.getElementById("savedSequence").textContent = capitalizeWords(document.getElementById("sequenceField").value);
  document.getElementById("editFields").style.display = "none";
  document.getElementById("savedHeader").style.display = "block";
}
function editHeader() {
  document.getElementById("editFields").style.display = "flex";
  document.getElementById("savedHeader").style.display = "none";
}
function capitalizeWords(str) {
  return str.replace(/\w\S*/g, (t) => t.charAt(0).toUpperCase() + t.substr(1).toLowerCase());
}
// PREVIEW MODE
function enterPreview(index = 0) {
  if (panels.length === 0) return;
  document.getElementById("mainStoryboard").style.display = "none";
  document.getElementById("previewArea").style.display = "block";
  showPreview(index);
}
function exitPreview() {
  document.getElementById("mainStoryboard").style.display = "block";
  document.getElementById("previewArea").style.display = "none";
}
function showPreview(idx) {
  currentPreviewIdx = idx;
  const panel = panels[idx];
  let shotText = panel.querySelector(".print-shotname").textContent;
  if (shotText && !shotText.endsWith(".")) shotText += ".";
  document.getElementById("previewShotName").textContent = shotText;
  document.getElementById("previewDesc").textContent = panel.querySelector(".print-description").textContent;
  document.getElementById("previewSelects").textContent = panel.querySelector(".print-select").textContent;
  const img = panel.querySelector(".storyboard-thumbnail");
  document.getElementById("previewThumb").src = img.src || "";
  document.getElementById("previewThumb").style.display = img.src ? "block" : "none";
  document.getElementById("prevBtn").disabled = idx === 0;
  document.getElementById("nextBtn").disabled = idx === panels.length - 1;
}
document.getElementById("previewModeBtn").onclick = () => enterPreview();
document.getElementById("exitPreviewBtn").onclick = exitPreview;
document.getElementById("prevBtn").onclick = () => showPreview(currentPreviewIdx - 1);
document.getElementById("nextBtn").onclick = () => showPreview(currentPreviewIdx + 1);
function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
}
// Initialize with panels (1 for mobile, 5 desktop)
for (let i = 0; i < (isMobile ? 1 : 5); i++) addPanel();
</script>
</body>
</html>
